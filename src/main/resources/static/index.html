<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auth67 - Admin Login</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body class="bg-gray-100 flex items-center justify-center h-screen">

    <div id="app" class="w-full max-w-xs">
        <form @submit.prevent="login" class="bg-white shadow-md rounded px-8 pt-6 pb-8 mb-4">
            <h2 class="text-2xl font-bold mb-6 text-center text-gray-800">Admin Login</h2>
            
            <div class="mb-4">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="username">
                    Username
                </label>
                <input v-model="username" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" id="username" type="text" placeholder="Username" required>
            </div>
            
            <div class="mb-6">
                <label class="block text-gray-700 text-sm font-bold mb-2" for="password">
                    Password
                </label>
                <input v-model="password" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 mb-3 leading-tight focus:outline-none focus:shadow-outline" id="password" type="password" placeholder="******************" required>
            </div>
            
            <div class="flex items-center justify-between">
                <button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline w-full" type="submit">
                    Sign In
                </button>
            </div>

            <p v-if="error" class="text-red-500 text-xs italic mt-4">{{ error }}</p>
        </form>
        <p class="text-center text-gray-500 text-xs">
            &copy; 2025 Auth67. All rights reserved.
        </p>
    </div>

    <script>
        const { createApp } = Vue

        createApp({
            data() {
                return {
                    username: '',
                    password: '',
                    error: null
                }
            },
            mounted() {
                // If already logged in, go to dashboard
                if (localStorage.getItem('access_token')) {
                    window.location.href = '/dashboard.html';
                }
            },
            methods: {
                async login() {
                    this.error = null;
                    try {
                        const response = await axios.post('/api/auth/login', {
                            username: this.username,
                            password: this.password
                        });

                        const { access_token, refresh_token } = response.data;
                        
                        localStorage.setItem('access_token', access_token);
                        localStorage.setItem('refresh_token', refresh_token);
                        localStorage.setItem('username', this.username);

                        window.location.href = '/dashboard.html';
                    } catch (err) {
                        this.error = 'Invalid credentials or server error.';
                        console.error(err);
                    }
                }
            }
        }).mount('#app')
    </script>
</body>
</html>
